{"version":3,"sources":["..\\..\\..\\..\\assets\\script/assets\\script\\main.ts"],"names":[],"mappings":"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","file":"","sourceRoot":"..\\..\\..\\..\\assets\\script","sourcesContent":["// 从 cc._decorator 命名空间中引入 ccclass 和 property 两个装饰器\r\nconst { ccclass, property } = cc._decorator;\r\nimport Hero from \"./hero\";\r\nimport App from \"./app\";\r\nimport Enemy from \"./enemy\";\r\nimport util from \"./util\";\r\n\r\n@ccclass\r\nexport default class Main extends cc.Component {\r\n    //pfbs_enemy\r\n    @property(cc.Prefab)\r\n    pfbs_enemy: cc.Prefab[] = [];\r\n\r\n    //btns_row\r\n    @property(cc.Node)\r\n    btns: cc.Node[] = [];\r\n\r\n    @property(cc.Node)\r\n    hero: cc.Node = null;\r\n\r\n    @property(cc.Node)\r\n    bg_1: cc.Node = null;\r\n\r\n    @property(cc.Node)\r\n    bg_2: cc.Node = null;\r\n\r\n    @property(cc.Label)\r\n    label_score: cc.Label = null;\r\n\r\n    @property(cc.Label)\r\n    label_clock: cc.Label = null;\r\n\r\n    score = 0;\r\n\r\n    // LIFE-CYCLE CALLBACKS:\r\n    onLoad() {\r\n        cc.director.getCollisionManager().enabled = true;\r\n        // cc.director.getCollisionManager().enabledDebugDraw = true;\r\n        // cc.director.getCollisionManager().enabledDrawBoundingBox = true;\r\n        //开启物理系统\r\n        // cc.director.getPhysicsManager().enabled = true;\r\n        //init enmey pools\r\n        for (let i = 0; i < this.pfbs_enemy.length; i++) {\r\n            App.Instance.AddTypePool(\"enemy\" + (i + 1), 20, this.pfbs_enemy[i]);\r\n        }\r\n\r\n        // 节点 b 的组件脚本中\r\n        this.node.on('enemy_destory', function (event) {\r\n            cc.log(\"敌机毁灭\");\r\n            let addScore = event.getUserData();\r\n            this.score += addScore;\r\n            this.label_score.string = this.score.toString();\r\n            event.stopPropagationImmediate();\r\n        }.bind(this));\r\n\r\n        //始终显示在最前面\r\n        this.node.getChildByName(\"btn_pause\").zIndex = 99;\r\n        this.label_score.node.zIndex = 100;\r\n        this.label_clock.node.zIndex = 101;\r\n    }\r\n\r\n    start() {\r\n        //背景移动\r\n        let t = 24\r\n        this.bg_1.runAction(cc.sequence(cc.moveBy(t, cc.v2(0, -this.node.height)), cc.callFunc(function () {\r\n            this.bg_1.setPosition(cc.v2(0, this.node.height));\r\n        }, this), cc.callFunc(function () {\r\n            this.bg_1.runAction(cc.repeatForever(cc.sequence(cc.moveBy(2 * t, cc.v2(0, -this.node.height * 2)), cc.callFunc(function () {\r\n                this.bg_1.rotation += 180;\r\n                this.bg_1.setPosition(cc.v2(0, this.node.height));\r\n            }, this))));\r\n        }, this)));\r\n        this.bg_2.runAction(cc.repeatForever(cc.sequence(cc.moveBy(2 * t, cc.v2(0, -this.node.height * 2)), cc.callFunc(function () {\r\n            this.bg_2.setPosition(cc.v2(0, this.node.height));\r\n        }, this))));\r\n\r\n        //btns addlisten TOUCH_START\r\n        for (let i = 0; i < this.btns.length; i++) {\r\n            this.btns[i].on(cc.Node.EventType.TOUCH_START, this._dirvePlane, this);\r\n            this.btns[i].on(cc.Node.EventType.TOUCH_CANCEL, this._stopDrivePlane, this);\r\n            this.btns[i].on(cc.Node.EventType.TOUCH_END, this._stopDrivePlane, this);\r\n        }\r\n\r\n        this.clockRun();\r\n\r\n        //test\r\n        this.hero.getComponent(Hero).autoFire();\r\n\r\n        //gen enemy1\r\n        this.schedule(function () {\r\n            this.genEnemy(1);\r\n        }.bind(this), 0.9, cc.macro.REPEAT_FOREVER);\r\n\r\n        //delay 30s\r\n        this.scheduleOnce(function () {\r\n            //gen enemy2\r\n            this.schedule(function () {\r\n                this.genEnemy(2);\r\n            }.bind(this), 2, cc.macro.REPEAT_FOREVER);\r\n        }.bind(this), 30);\r\n\r\n        //delay 50s\r\n        this.schedule(function () {\r\n            //gen enemy3\r\n            this.schedule(function () {\r\n                this.genEnemy(3);\r\n            }.bind(this), 4, cc.macro.REPEAT_FOREVER);\r\n        }.bind(this), 50);\r\n    }\r\n\r\n\r\n    //驱动飞机\r\n    private _dirvePlane(e): void {\r\n        this.hero.stopAllActions();\r\n        let s = 0;\r\n        if (e.currentTarget._name == \"_left\") {\r\n            s = -this.node.width / 2 - this.hero.x-10;\r\n        }else{\r\n            s= this.node.width / 2 - this.hero.x+10;\r\n        }\r\n        this.hero.runAction(cc.moveBy(Math.abs(s / 120), cc.v2(s, 0)).easing(cc.easeOut(1.5)));\r\n    }\r\n\r\n    //驱动停止\r\n    private _stopDrivePlane(e): void {\r\n        //缓动距离\r\n        let xS = 10;\r\n        if (e.currentTarget._name == \"_left\") {\r\n            xS = -xS;\r\n        }\r\n        this.hero.runAction(cc.sequence(cc.moveBy(0.6, cc.v2(xS, 0)).easing(cc.easeOut(1.5)), cc.callFunc(function () {\r\n            this.hero.stopAllActions();\r\n        }, this)));\r\n    }\r\n\r\n    // update (dt) {}\r\n\r\n    //敌机生成\r\n    genEnemy(kind: number) {\r\n        let enmy = App.Instance.GetNodeFromPool(\"enemy\" + kind);\r\n        let randX = -this.node.width / 2 + Math.random() * this.node.width;\r\n        enmy.setPosition(cc.v2(randX, 600));\r\n        this.node.addChild(enmy);\r\n        enmy.getComponent(Enemy).fly();\r\n        enmy.group = \"enemy\";\r\n    }\r\n\r\n    //游戏结束\r\n    gameOver() {\r\n        //停止所有定时器\r\n        this.unscheduleAllCallbacks();\r\n        // cc.log(\"game over!\");\r\n        cc.sys.localStorage.setItem(\"score\", this.label_score.string);\r\n\r\n        let maxScore = Number(cc.sys.localStorage.getItem(\"maxScore\")||0);\r\n        if (this.score > maxScore) {\r\n            cc.sys.localStorage.setItem(\"maxScore\", this.score)\r\n        }\r\n        let newScoreObj = {\r\n            \"time\": util.TimeFormt(new Date()),\r\n            \"score\": this.score,\r\n        }\r\n        let historyScores=JSON.parse(cc.sys.localStorage.getItem(\"history_scores\")||\"[]\");\r\n        //保留10条历史记录\r\n        // if(historyScores.length>=11)historyScores.pop();\r\n        while (historyScores.length >= 11) {\r\n            historyScores.pop();\r\n        }\r\n        historyScores.unshift(newScoreObj);\r\n        cc.sys.localStorage.setItem(\"history_scores\", JSON.stringify(historyScores));\r\n\r\n        cc.director.loadScene(\"end\", () => {\r\n            cc.log(\"loaded end scene success\");\r\n        });\r\n    }\r\n\r\n    //游戏暂停\r\n    gamePause() {\r\n        this.node.getChildByName(\"btn_pause\").active = false;\r\n        this.node.getChildByName(\"btn_resume\").active = true;\r\n        cc.game.pause();\r\n    }\r\n\r\n    //游戏恢复\r\n    gameResume() {\r\n        this.node.getChildByName(\"btn_pause\").active = true;\r\n        this.node.getChildByName(\"btn_resume\").active = false;\r\n        cc.game.resume();\r\n    }\r\n\r\n    clockRun() {\r\n        let _30s = 30;\r\n        let _60s = 60;\r\n        let tick = function () {\r\n            //90秒结束游戏\r\n            if (_30s <= 1) {\r\n                _60s--;\r\n                if (_60s <= 0) {\r\n                    this.gameOver();\r\n                }\r\n                this.label_clock.string = \"\" + _60s;\r\n                return\r\n            }\r\n            _30s--;\r\n            if (_30s < 10) {\r\n                this.label_clock.string = \"1:0\" + _30s;\r\n                return\r\n            }\r\n            this.label_clock.string = \"1:\" + _30s;\r\n\r\n        }\r\n        this.schedule(tick.bind(this), 1, cc.macro.REPEAT_FOREVER)\r\n    }\r\n}\r\n"]}